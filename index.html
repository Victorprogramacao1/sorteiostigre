<!DOCTYPE html> <html lang="pt-BR"> <head> <meta charset="UTF-8"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <meta name="description" content="Sistema de sorteios e concursos online - Participe de forma segura e transparente"> <meta name="keywords" content="sorteio, concurso, participar, ganhador, pr√™mio"> <meta name="author" content="Sistema de Sorteios"> <meta name="robots" content="index, follow"> <meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' https://www.gstatic.com; script-src 'self' 'unsafe-inline' https://www.gstatic.com; style-src 'self' 'unsafe-inline';"> <meta http-equiv="X-Content-Type-Options" content="nosniff"> <meta http-equiv="X-Frame-Options" content="DENY"> <meta http-equiv="X-XSS-Protection" content="1; mode=block"> <title>Sistema de Sorteios - Participar do Concurso</title> <style> body { box-sizing: border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; margin: 0; padding: 20px; display: flex; align-items: center; justify-content: center; } .container { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1); largura: 100%; largura m√°xima: 450px; alinhamento do texto: centro; } .title { cor: #333; tamanho da fonte: 28px; espessura da fonte: 700; margem inferior: 30px; plano de fundo: gradiente linear(135deg, #667eea, #764ba2); -webkit-background-clip: texto; -webkit-text-fill-color: transparente; clipe de fundo: texto; } .form-group { margem inferior: 25px; alinhamento do texto: esquerda; } .form-label { exibi√ß√£o: bloco; cor: #555; espessura da fonte: 600; margem inferior: 8px; tamanho da fonte: 14px; transforma√ß√£o do texto: mai√∫sculas; espa√ßamento entre letras: 0,5px; } .form-input { largura: 100%; preenchimento: 15px 20px; borda: 2px s√≥lido #e1e5e9; raio da borda: 12px; tamanho da fonte: 16px; transi√ß√£o: todos 0,3s facilidade; plano de fundo: #f8f9fa; tamanho da caixa: caixa da borda; } .form-input: foco { contorno:nenhum; cor da borda: #667eea; plano de fundo: branco; sombra da caixa: 0 0 0 3px rgba(102, 126, 234, 0.1); } .submit-btn { plano de fundo: gradiente linear(135 graus, #667eea 0%, #764ba2 100%); cor: branco; borda: nenhuma; preenchimento: 18px 40px; raio da borda: 12px; tamanho da fonte: 18px; espessura da fonte: 600; cursor: ponteiro; transi√ß√£o: todos 0,3s facilidade; largura: 100%; transforma√ß√£o de texto: mai√∫sculas; espa√ßamento entre letras: 1px; margem superior: 10px; } .submit-btn: pairar { transformar: traduzirY(-2px); box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3); } .submit-btn:active { transform: translateY(0); } .success-message { background: #d4edda; color: #155724; padding: 15px; border-radius: 8px; margin-top: 20px; border: 1px solid #c3e6cb; display: none; } .confetti { position: fixed; width: 10px; height: 10px; background: #f39c12; animation: confetti-fall 3s linear infinite; z-index: 1000; } .confetti:nth-child(odd) { background: #e74c3c; width: 8px; height: 8px; animation-duration: 2.5s; } .confetti:nth-child(even) { background: #3498db; } .confetti:nth-child(3n) { background: #2ecc71; width: 6px; height: 6px; animation-duration: 3.5s; } .confetti:nth-child(4n) { background: #9b59b6; width: 12px; height: 4px; } .confetti:nth-child(5n) { background: #f1c40f; width: 4px; height: 12px; animation-duration: 2.8s; } @keyframes confetti-fall { 0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } } .celebration-overlay { posi√ß√£o: fixa; topo: 0; esquerda: 0; largura: 100%; altura: 100%; eventos de ponteiro: nenhum; √≠ndice z: 999; exibi√ß√£o: nenhum; } .firework { posi√ß√£o: absoluta; largura: 4px; altura: 4px; raio da borda: 50%; anima√ß√£o: avan√ßo gradual do firework 1s; } @keyframes firework { 0% { transform: escala(1); opacidade: 1; } 100% { transform: escala(20); opacidade:0; } } .bounce-animation { anima√ß√£o: bounce 0,6s ease-in-out; } @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-20px); } 60% { transform: translateY(-10px); } } .secret-button { posi√ß√£o: fixa; inferior: 15px; direita: 15px; largura: 30px; altura: 30px; plano de fundo: rgba(0, 0, 0, 0,1); raio da borda: 50%; exibi√ß√£o: flex; itens de alinhamento: centralizar; justificar conte√∫do: centralizar; cursor: ponteiro; tamanho da fonte: 12px; opacidade: 0,2; transi√ß√£o: todos 0,3s ease; z-index: 100; } .secret-button:hover { opacidade: 0,5; transforma√ß√£o: escala(1,05); } .secret-modal { exibi√ß√£o: nenhuma; posi√ß√£o: fixa; √≠ndice z: 2000; esquerda: 0; topo: 0; largura: 100%; altura: 100%; cor de fundo: rgba(0, 0, 0, 0, 0,5); filtro de pano de fundo: desfoque(5px); } .secret-modal-content { cor de fundo: branco; margem: 15% autom√°tico; preenchimento: 30px; raio da borda: 15px; largura: 90%; largura m√°xima: 400px; alinhamento do texto: centralizado; posi√ß√£o: relativa; sombra da caixa: 0 20px 40px rgba(0, 0, 0, 0, 0,2); } .login-form { margem superior: 20px; } .password-input { largura: 100%; preenchimento: 12px 16px; borda: 2px s√≥lido #e1e5e9; raio da borda: 8px; tamanho da fonte: 16px; margem: 10px 0; tamanho da caixa: caixa da borda; } .password-input: foco { contorno: nenhum; cor da borda: #667eea; } .database-view { exibi√ß√£o: nenhum; alinhamento do texto: esquerda; margem superior: 20px; } .user-table { largura: 100%; colapso da borda: colapso; margem superior: 15px; } .user-table th, .user-table td { preenchimento: 10px; borda: 1px s√≥lido #ddd; alinhamento do texto: esquerda; } .user-table th { plano de fundo: #f8f9fa; espessura da fonte: 600; } .user-table tr:nth-child(even) { background: #f8f9fa; } .error-message { color: #dc3545; font-size: 14px; margin-top: 10px; } .close-modal { position: absolute; right: 15px; top: 15px; font-size: 24px; cursor: pointer; color: #999; } .close-modal:hover { cor: #333; } .admin-options { margem superior: 20px; } .admin-btn { display: bloco; largura: 100%; margem: 10px 0; preenchimento: 12px; plano de fundo: gradiente linear (135 graus, #667eea, #764ba2); cor: branco; borda: nenhuma; raio da borda: 8px; cursor: ponteiro; tamanho da fonte: 14px; transi√ß√£o: todos 0,3s facilidade; } .admin-btn: hover { transform: translateY (-2px); sombra da caixa: 0 5px 15px rgba (102, 126, 234, 0,3); } . indicador de carregamento { display: nenhum; alinhamento do texto: centro; preenchimento: 20px; cor: #667eea; espessura da fonte: 600; } .firebase-status { background: #e8f5e8; color: #2d5a2d; padding: 10px; border-radius: 8px; margin: 10px 0; font-size: 12px; text-align: center; border: 1px solid #c3e6cb; } /* Estilos Profissionais do Sorteio */ .raffle-header { background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 25px; border-radius: 15px; margin-bottom: 30px; box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3); } .raffle-title { font-size: 32px; font-weight: 900; margin: 0 0 8px 0; text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3); espa√ßamento entre letras: 2px; } .raffle-subtitle { font-size: 14px; opacity: 0.9; font-weight: 500; letter-spacing: 1px; } .raffle-phase { background: white; border-radius: 20px; padding: 40px; margin: 20px 0; box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1); border: 2px solid #f0f0f0; } .phase-title { font-size: 24px; font-weight: 700; color: #333; margin-bottom: 30px; text-transform: uppercase; letter-spacing: 2px; position: relative; } .phase-title::after { content: ''; position: absolute; bottom: -10px; left: 50%; transform: translateX(-50%); width: 60px; height: 3px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 2px; } /* Contagem Regressiva Profissional */ .countdown-display { position: relative; display: flex; justify-content: center; margin: 40px 0; } .countdown-circle-pro { position: relative; width: 200px; height:200px; display: flex; align-items: center; justify-content: center; } .countdown-ring { position: absolute; top: 0; left: 0; transform: rotate(-90deg); } .countdown-ring circle:last-child { transition: stroke-dashoffset 1s ease-in-out; } .countdown-number-pro { font-size: 64px; font-weight: 900; color: #667eea; z-index: 10; text-shadow: 0 4px 8px rgba(102, 126, 234, 0.3); animation: number-pulse 0.8s ease-out; } .countdown-status { font-size: 18px; color: #666; font-weight: 500; margin-top: 20px; animation: status-fade 2s ease-in-out infinite alternate; } /* Sele√ß√£o de Participantes */ .participants-display { text-align: center; padding: 40px 0; } .participants-counter { font-size: 28px; font-weight: 700; color: #667eea; margin-bottom: 30px; } .participants-counter span { font-size: 48px; color: #764ba2; } .participants-animation { display: flex; justify-content: center; align-items: center; height: 60px; } .loading-dots { display: flex; gap: 8px; } .loading-dots span { width: 12px; height: 12px; border-radius: 50%; background: #667eea; anima√ß√£o: loading-bounce 1.4s ease-in-out infinito ambos; } .loading-dots span:nth-child(1) { animation-delay: -0.32s; } .loading-dots span:nth-child(2) { animation-delay: -0.16s; } /* Algoritmo de Sorteio */ .algorithm-display { text-align: center; padding: 40px 0; } .algorithm-visual { margin: 30px 0; } .spinning-wheel { width: 120px; height: 120px; border: 8px solid #e0e0e0; border-top: 8px solid #667eea; border-radius: 50%; margin: 0 auto; anima√ß√£o: wheel-spin 1s linear infinito; display: flex; align-items: center; justify-content: center; position: relative; } .wheel-center { tamanho da fonte: 32px; anima√ß√£o: wheel-center-counter 1s linear infinito reverso; } .algorithm-status { tamanho da fonte: 18px; cor: #666; peso da fonte: 500; margem superior: 20px; } /* Resultado final */ .result-container { largura m√°xima: 500px; margem: 0 auto; } .result-header { margem inferior:30px; } .trophy-animation { tamanho da fonte: 64px; anima√ß√£o: trophy-bounce 2s entrada/sa√≠da infinita; margem inferior: 15px; } .result-title { tamanho da fonte: 28px; espessura da fonte: 900; cor: #155724; margem: 0; transforma√ß√£o do texto: mai√∫scula; espa√ßamento entre letras: 2px; } .winner-card { plano de fundo: gradiente linear (135 graus, #d4edda, #c3e6cb); borda: 3px s√≥lido #28a745; raio da borda: 20px; preenchimento: 40px; sombra da caixa: 0 15px 35px rgba (40, 167, 69, 0,2); posi√ß√£o: relativa; estouro: oculto; } .winner-card::antes { conte√∫do: ''; posi√ß√£o: absoluta; topo: -50%; esquerda: -50%; largura: 200%; altura: 200%; plano de fundo: gradiente linear (45 graus, transparente, rgba (255, 255, 255, 0,1), transparente); anima√ß√£o: card-shine 3s ease-in-out infinito; } .winner-badge { plano de fundo: # 28a745; cor: branco; preenchimento: 8px 20px; raio da borda: 20px; tamanho da fonte: 12px; espessura da fonte: 700; transforma√ß√£o de texto: mai√∫scula; espa√ßamento entre letras: 1px; margem inferior: 20px; exibi√ß√£o: bloco embutido; } .winner-name { tamanho da fonte: 36px; espessura da fonte: 900; cor: # 155724; margem inferior: 25px; anima√ß√£o: winner-glow 2s facilidade de entrada e sa√≠da infinita alternada; } .winner-details { margem: 25px 0; } .detail-item { exibi√ß√£o: flex; justify-content: espa√ßo entre; alinhar-itens: centro; preenchimento: 12px 0; borda inferior: 1px s√≥lido rgba(21, 87, 36, 0.1); } .detail-label { peso da fonte: 600; cor: #155724; } .detail-value { peso da fonte: 700; cor: #28a745; } .winner-certificate { plano de fundo: rgba(255, 255, 255, 0.8); borda: 2px tracejada #28a745; raio da borda: 10px; preenchimento: 15px; margem superior: 25px; } .certificate-text { font-size: 14px; color: #155724; font-weight: 600; } .certificate-number { font-size: 12px; color: #666; margin-top: 5px; } /* Bot√µes de A√ß√£o */ .raffle-actions { display: flex; gap: 15px; justify-content: center; margin-top: 30px; } .action-btn { padding: 15px 30px; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor:ponteiro; transi√ß√£o: todos 0,3s de facilidade; transforma√ß√£o de texto: mai√∫sculas; espa√ßamento entre letras: 1px; } .action-btn.primary { background: linear-gradient(135deg, #667eea, #764ba2); cor: branco; } .action-btn.secondary { background: branco; cor: #667eea; borda: 2px s√≥lido #667eea; } .action-btn:hover { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2); } /* Anima√ß√µes */ @keyframes number-pulse { 0% { transform: scale(0.8); opacity: 0; } 50% { transform: scale(1.1); } 100% { transform: scale(1); opacity: 1; } } @keyframes status-fade { 0% { opacidade: 0,7; } 100% { opacidade: 1; } } @keyframes loading-bounce { 0%, 80%, 100% { transform: scale(0); } 40% { transform: scale(1); } } @keyframes wheel-spin { 0% { transform: rotate(0 graus); } 100% { transform: rotate(360 graus); } } @keyframes wheel-center-counter { 0% { transform: rotate(0 graus); } 100% { transform: rotate(-360 graus); } } @keyframes trophy-bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-10px); } 60% { transform: translateY(-5px); } } @keyframes card-shine { 0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); } 100% { transform: translateX(100%) translateY(100%) rotate(45deg); } } @keyframes winner-glow { 0% { text-shadow: 0 0 5px rgba(21, 87, 36, 0.5); } 100% { text-shadow: 0 0 20px rgba(21, 87, 36, 0.8), 0 0 30px rgba(21, 87, 36, 0.6); } } @keyframes name-flash { 0% { transform: scale(0.9); opacity: 0.8; } 50% { transformar: escala(1,05); opacidade: 1; } 100% { transformar: escala(1); opacidade: 1; } } @keyframes dramatic-pause { 0% { transformar: escala(0,8); opacidade: 0; } 50% { transformar: escala(1,1); opacidade: 0,8; } 100% { transformar: escala(1); opacidade: 1; } } @media (largura-m√°xima:480px) { .container { preenchimento: 30px 20px; margem: 10px; } .title { tamanho da fonte: 24px; } .secret-button { inferior: 15px; direita: 15px; largura: 35px; altura: 35px; tamanho da fonte: 16px; } .countdown-circle { largura: 100px; altura: 100px; } .countdown-circle::before { largura: 110px; altura: 110px; } .countdown-number { tamanho da fonte: 40px; } } </style> </head> <body> <div class="container"> <h1 class="title">üéØ Sistema de Sorteios</h1> <form id="concursoForm"> <div class="form-group"> <label class="form-label" for="platformId">ID na Plataforma</label> <input type="number" id="platformId" name="platformId" class="form-input" placeholder="Digite seu ID da plataforma" required > </div> <div class="form-group"> <label class="form-label" for="firstName">Nome</label> <input type="text" id="firstName" name="firstName" class="form-input" placeholder="Digite seu nome" required > </div> <button type="submit" class="submit-btn"> Correr Agora </button> </form> <div id="successMessage" class="success-message"> ‚úÖ Inscri√ß√£o realizada com sucesso! Boa sorte no sorteio! </div> <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px; border-left: 4px s√≥lido #28a745; font-size: 14px; color: #666;"> <div style="font-weight: 600; color: #28a745; margin-bottom: 8px;">üõ°Ô∏è Site Seguro e Confi√°vel</div> <div>Este √© um sistema leg√≠timo de sorteios. Todos os dados s√£o processados ‚Äã‚Äãlocalmente no seu navegador e n√£o s√£o enviados para servidores externos. O sorteio √© realizado de forma transparente e convocada.</div> </div> </div> <div id="celebrationOverlay" class="celebration-overlay"></div> <!-- Bot√£o discreto --> <div id="secretButton" class="secret-button">‚Ä¢</div> <!-- Modal administrativo --> <div id="secretModal" class="secret-modal"> <div class="secret-modal-content"> <span class="close-modal">√ó</span> <!-- Tela de Login --> <div id="loginScreen"> <h3>üîê Acesso Administrativo</h3> <div class="login-form"> <input type="password" id="adminPassword" class="password-input" placeholder="Digite a senha administrativa" > <button class="admin-btn" onclick="checkPassword()">Entrar</button> <div id="errorMessage" class="error-message" style="display: none;"></div> </div> </div> <!-- Banco de Dados --> <div id="databaseScreen" class="database-view"> <h3>üìä Banco de Dados Firebase</h3> <div id="firebaseStatus" class="firebase-status"> üî• Conectado ao Firebase Firestore </div> <div id="loadingIndicator" class="loading-indicator"> Carregando dados do Firebase... </div> <table class="user-table"> <thead> <tr> <th>ID Plataforma</th> <th>Nome</th> <th>Inscri√ß√£o de dados</th> </tr> </thead> <tbody id="userTableBody"> <!-- Os dados ser√£o inseridos aqui --> </tbody> </table> <div style="margin-top: 20px; text-align: center;"> <button class="admin-btn" onclick="startQuickRaffle()">üé≤ Iniciar Sorteio</button> <button class="admin-btn" onclick="clearAllData()" style="background: gradiente-linear(135 graus, #dc3545,#c82333);">üóëÔ∏è Limpar Dados</button> <button class="admin-btn" onclick="logout()">Sair</button> </div> <!-- Tela de Sorteio Simples --> <div id="raffleDisplay" style="display: none; text-align: center; margin-top: 30px; padding: 30px; background: #f8f9fa; border-radius: 15px; border: 2px solid #667eea;"> <h3 id="raffleTitle" style="color: #667eea; font-size: 24px; margin-bottom: 20px;">üéØ SORTEANDO...</h3> <div id="raffleContent" style="font-size: 28px; font-weight: bold; color: #333; min-height: 80px; display: flex; align-items: center; justify-content: center; background: white; border-radius: 10px; margin: 20px 0; animation: name-flash 0.2s ease-in-out;"> Preparando sorteio... </div> <div id="raffleStatus" style="color: #666; font-size: 16px; margin-top: 15px;"> Aguarde 5 segundos... </div> <button id="backToTableBtn" class="admin-btn" onclick="backToTable()" style="display: none; margin-top: 20px;">üìä Voltar √† Tabela</button> </div> </div> </div> </div> <script type="module"> // Configura√ß√£o do Firebase import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js"; import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc, query, orderBy } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js"; const firebaseConfig = { apiKey: "AIzaSyAAkfRicJgQbCK9KSM0Ic0wUVNKnvb5B4Y", authDomain: "sorteios-336f0.firebaseapp.com", projectId: "sorteios-336f0", storageBucket: "sorteios-336f0.firebasestorage.app", messagingSenderId: "168400059081", appId: "1:168400059081:web:89000c0b7fd09a71f6eb18", measurementId: "G-H96WRM7KVX" }; // Inicializar o Firebase const app = initializeApp(firebaseConfig); const db = getFirestore(app); // Banco de dados local (backup) let usersDatabase = []; const adminPassword = 'admin123'; function createConfetti() { const celebrationOverlay = document.getElementById('celebrationOverlay'); celebrationOverlay.style.display = 'block'; // Criar confetes for (let i = 0; i < 50; i++) { const confetti = document.createElement('div'); confetti.className = 'confete'; confetti.style.left = Math.random() * 100 + '%'; confetti.style.animationDelay = Math.random() * 3 + 's'; confetti.style.animationDuration = (Math.random() * 2 + 2) + 's'; celebrationOverlay.appendChild(confete); } // Criar fogos de artif√≠cio for (let i = 0; i < 8; i++) { setTimeout(() => { const firework = document.createElement('div'); firework.className = 'firework'; firework.style.left = Math.random() * 100 + '%'; firework.style.top = Math.random() * 50 + '%'; const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#ffeaa7', '#dda0dd', '#98d8c8']; firework.style.background = colors[Math.floor(Math.random() * colors.length)]; celebrationOverlay.appendChild(firework); setTimeout(() => { firework.remove(); }, 1000); }, i * 200); } // Limpar confetes ap√≥s 4 segundos setTimeout(() => { celebra√ß√£oOverlay.innerHTML = ''; celebra√ß√£oOverlay.style.display = 'none'; }, 4000); } // Bloquear letras no campo ID document.getElementById('platformId').addEventListener('keypress', function(e) { // Permitir apenas n√∫meros (0-9) if (!/[0-9]/.test(e.key) && e.key !== 'Backspace' && e.key !== 'Delete' && e.key !== 'Tab' && e.key !== 'Enter') { e.preventDefault() } }); // Bloquear colar texto com letras document.getElementById('platformId').addEventListener('paste', function(e) { e.preventDefault(); const paste = (e.clipboardData || window.clipboardData).getData('text'); if (/^\d+$/.test(paste)) { this.value = paste; } }); // Bot√£o administrativo document.getElementById('secretButton').addEventListener('click', function() { document.getElementById('secretModal').style.display = 'block'; showLoginScreen(); }); // Verificar senha window.checkPassword = function() { const inputPassword = document.getElementById('adminPassword').value; const errorDiv = document.getElementById('errorMessage'); if (inputPassword === adminPassword) { showDatabaseScreen(); errorDiv.style.display = 'none'; } else { errorDiv.textContent = 'Senha incorreta!'; errorDiv.style.display = 'block'; document.getElementById('adminPassword').value = ''; } } // Mostrar tela de login function showLoginScreen() { document.getElementById('loginScreen').style.display = 'block'; document.getElementById('databaseScreen').style.display = 'none'; document.getElementById('adminPassword').value = ''; document.getElementById('errorMessage').style.display = 'none'; } // Exibir banco de dados function showDatabaseScreen() { document.getElementById('loginScreen').style.display = 'none'; document.getElementById('databaseScreen').style.display = 'block'; loadUserDataFromFirebase(); } // Carregar dados do Firebase async function loadUserDataFromFirebase() { const loadingDiv = document.getElementById('loadingIndicator'); const tbody = document.getElementById('userTableBody'); try { loadingDiv.style.display = 'block'; tbody.innerHTML = '<tr><td colspan="3" style="text-align: center; color: #666;">Carregando...</td></tr>'; const q = query(collection(db, "participants"), orderBy("date", "desc")); const querySnapshot = await getDocs(q); usersDatabase = []; tbody.innerHTML = ''; if (querySnapshot.empty) { tbody.innerHTML = '<tr><td colspan="3" style="text-align: center; color: #666;">Nenhum usu√°rio inscrito ainda</td></tr>'; loadingDiv.style.display = 'none'; return; } querySnapshot.forEach((doc) => { const userData = doc.data(); userData.id = doc.id; // Salvar ID do documento usersDatabase.push(userData); const row = tbody.insertRow(); row.insertCell(0).textContent = userData.platformId; row.insertCell(1).textContent = userData.firstName; row.insertCell(2).textContent = userData.date; }); // Atualizar documento de status.getElementById('firebaseStatus').innerHTML = `üî• ${usersDatabase.length} participantes carregados do Firebase`;
                
            } catch (error) {
                console.error("Erro ao carregar dados:", error);
                tbody.innerHTML = '<tr><td colspan="3" style="text-align: center; color: #dc3545;">Erro ao carregar dados do Firebase</td></tr>';
                document.getElementById('firebaseStatus').innerHTML = '‚ùå Erro de conex√£o com Firebase';
                document.getElementById('firebaseStatus').style.background = '#f8d7da';
                document.getElementById('firebaseStatus').style.color = '#721c24';
            } finally {
                loadingDiv.style.display = 'none';
            }
        }

        // Salvar usu√°rio no Firebase
        async function saveUserToFirebase(platformId, firstName) {
            try {
                // Verificar se ID j√° existe
                const q = query(collection(db, "participants"));
                const querySnapshot = await getDocs(q);
                
                let idExists = false;
                querySnapshot.forEach((doc) => {
                    if (doc.data().platformId === platformId) {
                        idExists = true;
                    }
                });
                
                if (idExists) {
                    alert('‚ùå Este ID j√° est√° cadastrado no sistema!');
                    return false;
                }
                
                // Salvar no Firebase
                const docRef = await addDoc(collection(db, "participants"), {
                    platformId: platformId,
                    firstName: firstName,
                    date: new Date().toLocaleString('pt-BR'),
                    timestamp: new Date()
                });
                
                console.log("Documento salvo com ID: ", docRef.id);
                
                // Salvar backup local
                const newUser = {
                    platformId: platformId,
                    firstName: firstName,
                    date: new Date().toLocaleString('pt-BR')
                };
                
                let localUsers = JSON.parse(localStorage.getItem('usersDatabase')) || [];
                localUsers.push(newUser);
                localStorage.setItem('usersDatabase', JSON.stringify(localUsers));
                
                return true;
                
            } catch (error) {
                console.error("Erro ao salvar no Firebase:", error);
                
                // Fallback para localStorage se Firebase falhar
                const newUser = {
                    platformId: platformId,
                    firstName: firstName,
                    date: new Date().toLocaleString('pt-BR')
                };
                
                let localUsers = JSON.parse(localStorage.getItem('usersDatabase')) || [];
                
                // Verificar duplicata local
                const exists = localUsers.some(user => user.platformId === platformId);
                if (exists) {
                    alert('‚ùå Este ID j√° est√° cadastrado no sistema!');
                    return false;
                }
                
                localUsers.push(newUser);
                localStorage.setItem('usersDatabase', JSON.stringify(localUsers));
                
                alert('‚ö†Ô∏è Salvo localmente (Firebase indispon√≠vel)');
                return true;
            }
        }

        // Limpar todos os dados do Firebase
        window.clearAllData = async function() {
            if (usersDatabase.length === 0) {
                alert('N√£o h√° dados para limpar!');
                return;
            }
            
            const confirmDelete = confirm(`‚ö†Ô∏è ATEN√á√ÉO!\n\nVoc√™ tem certeza que deseja APAGAR TODOS OS DADOS?\n\nüìä Total de usu√°rios: ${usersDatabase.length}\n\n‚ö†Ô∏è Esta a√ß√£o N√ÉO PODE ser desfeita!`);
            
            if (confirmDelete) {
                const doubleConfirm = confirm('üö® CONFIRMA√á√ÉO FINAL üö®\n\nDigite OK para confirmar a exclus√£o PERMANENTE de todos os dados.\n\nEsta √© sua √∫ltima chance de cancelar!');
                
                if (doubleConfirm) {
                    try {
                        // Mostrar loading
                        document.getElementById('loadingIndicator').style.display = 'block';
                        document.getElementById('loadingIndicator').textContent = 'Apagando dados do Firebase...';
                        
                        // Apagar todos os documentos do Firebase
                        const q = query(collection(db, "participants"));
                        const querySnapshot = await getDocs(q);
                        
                        const deletePromises = [];
                        querySnapshot.forEach((document) => {
                            deletePromises.push(deleteDoc(doc(db, "participants", document.id)));
                        });
                        
                        await Promise.all(deletePromises);
                        
                        // Limpar dados locais
                        usersDatabase = [];
                        localStorage.removeItem('usersDatabase');
                        
                        // Recarregar tabela
                        await loadUserDataFromFirebase();
                        
                        // Mostrar confirma√ß√£o
                        alert('‚úÖ Todos os dados foram apagados com sucesso!\n\nüóëÔ∏è Firebase e backup local limpos\nüìä 0 usu√°rios restantes');
                        
                    } catch (error) {
                        console.error("Erro ao limpar Firebase:", error);
                        
                        // Fallback: limpar apenas local
                        usersDatabase = [];
                        localStorage.removeItem('usersDatabase');
                        document.getElementById('userTableBody').innerHTML = '<tr><td colspan="3" style="text-align: center; color: #666;">Nenhum usu√°rio inscrito ainda</td></tr>';
                        
                        alert('‚ö†Ô∏è Dados locais limpos (erro no Firebase)');
                    } finally {
                        document.getElementById('loadingIndicator').style.display = 'none';
                    }
                }
            }
        }

        // Logout
        window.logout = function() {
            showLoginScreen();
        }

        // Iniciar sorteio r√°pido de 5 segundos
        window.startQuickRaffle = function() {
            if (usersDatabase.length === 0) {
                alert('N√£o h√° usu√°rios cadastrados para sortear!');
                return;
            }
            
            if (usersDatabase.length === 1) {
                alert('√â necess√°rio pelo menos 2 usu√°rios para realizar um sorteio!');
                return;
            }
            
            // Mostrar tela de sorteio
            document.getElementById('raffleDisplay').style.display = 'block';
            document.getElementById('raffleTitle').textContent = 'üéØ SORTEANDO...';
            document.getElementById('raffleContent').textContent = 'Preparando sorteio...';
            document.getElementById('raffleStatus').textContent = 'Aguarde 6 segundos...';
            document.getElementById('backToTableBtn').style.display = 'none';
            
            let currentIndex = 0;
            let speed = 50; // Velocidade inicial (ms)
            let iterations = 0;
            const maxIterations = 120; // Total de itera√ß√µes em 6 segundos
            
            const raffleInterval = setInterval(() => {
                // Selecionar usu√°rio aleat√≥rio
                currentIndex = Math.floor(Math.random() * usersDatabase.length);
                const currentUser = usersDatabase[currentIndex];
                
                // Mostrar usu√°rio atual
                document.getElementById('raffleContent').innerHTML = `
                    <div style="animation: name-flash 0.1s ease-in-out;">
                        <div style="font-size: 18px; color: #999; margin-bottom: 8px;">ID: ${currentUser.platformId}</div>
                        <div style="font-size: 32px; color:#667eea;">${currentUser.firstName}</div>
                    </div>
                `;
                
                iterations++;
                
                // Diminuir velocidade gradualmente para criar suspense
                if (iterations > 80) {
                    speed += 15; // Desacelerar mais r√°pido no final
                } else if (iterations > 50) {
                    speed += 8; // Desacelerar moderadamente
                } else if (iterations > 25) {
                    speed += 3; // Desacelerar levemente
                }
                
                // Parar ap√≥s aproximadamente 5 segundos
                if (iterations >= maxIterations) {
                    clearInterval(raffleInterval);
                    
                    // Pausa dram√°tica antes de mostrar o ganhador
                    document.getElementById('raffleContent').innerHTML = `
                        <div style="font-size: 28px; color: #667eea; animation: dramatic-pause 1s ease-in-out;">
                            ü•Å E O GANHADOR √â... ü•Å
                        </div>
                    `;
                    
                    setTimeout(() => {
                        showWinner(currentUser);
                    }, 1500);
                }
            }, speed);
            
            // Ajustar intervalo dinamicamente
            let speedAdjuster = setInterval(() => {
                clearInterval(raffleInterval);
                
                const newInterval = setInterval(() => {
                    currentIndex = Math.floor(Math.random() * usersDatabase.length);
                    const currentUser = usersDatabase[currentIndex];
                    
                    document.getElementById('raffleContent').innerHTML = `
                        <div style="animation: name-flash 0.1s ease-in-out;">
                            <div style="font-size: 18px; color: #999; margin-bottom: 8px;">ID: ${currentUser.platformId}</div>
                            <div style="font-size: 32px; color: #667eea;">${currentUser.firstName}</div>
                        </div>
                    `;
                    
                    iterations++;
                    
                    if (iterations >= maxIterations) {
                        clearInterval(newInterval);
                        clearInterval(speedAdjuster);
                        
                        document.getElementById('raffleContent').innerHTML = `
                            <div style="font-size: 28px; color: #667eea; animation: dramatic-pause 1s ease-in-out;">
                                ü•Å E O GANHADOR √â...ü•Å </div> `; setTimeout(() => { showWinner(currentUser); }, 1500); } }, speed); speed += (itera√ß√µes > 80) ? 15 : (itera√ß√µes > 50) ? 8 : 3; }, 100); } // Mostrar ganhador final function showWinner(winner) { const now = new Date(); document.getElementById('raffleTitle').innerHTML = 'üèÜ GANHADOR OFICIAL'; document.getElementById('raffleContent').innerHTML = ` <div style="background: linear-gradient(135deg, #d4edda, #c3e6cb); padding: 30px; border-radius: 15px; border: 3px solid #28a745;"> <div style="background: #28a745; color: white; padding: 8px 20px; border-radius: 20px; font-size: 12px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 20px; display: inline-block;"> VENCEDOR </div> <div style="font-size: 36px; font-weight: 900; color: #155724; margin-bottom: 20px;"> ${winner.firstName} </div> <div style="text-align: left; margin: 20px 0;"> <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(21, 87, 36, 0.1);"> <span style="font-weight: 600; color: #155724;">ID:</span> <span style="font-weight: 700; color: #28a745;">${winner.platformId}</span> </div> <div style="display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid rgba(21, 87, 36, 0.1);"> <span style="font-weight: 600; color: #155724;">Dados:</span> <span style="font-weight: 700; color: #28a745;">${now.toLocaleDateString('pt-BR')}</span> </div> <div style="display: flex; justify-content: space-between; padding: 8px 0;"> <span style="font-weight: 600; color: #155724;">Hor√°rio:</span> <span style="font-weight: 700; color: #28a745;">${now.toLocaleTimeString('pt-BR')}</span> </div> </div> </div> `; document.getElementById('raffleStatus').innerHTML = ` <div style="color: #28a745; font-weight: bold;"> ‚úÖ Sorteio conclu√≠do com sucesso! </div> `; document.getElementById('backToTableBtn').style.display = 'inline-block'; // Crie confetes de celebra√ß√£o createConfetti(); } // Volte para a tabela window.backToTable = function() { document.getElementById('raffleDisplay').style.display = 'none'; } // Enter para fazer login document.getElementById('adminPassword').addEventListener('keypress', function(e) { if (e.key === 'Enter') { checkPassword(); } }); // Fechar modal document.querySelector('.close-modal').addEventListener('click', function() { document.getElementById('secretModal').style.display = 'none'; }); // Feche modal clicando fora document.getElementById('secretModal').addEventListener('click', function(e) { if (e.target === this) { this.style.display = 'none'; } }); document.getElementById('concursoForm').addEventListener('submit', async function(e) { e.preventDefault(); const platformId = document.getElementById('platformId').value; const firstName = document.getElementById('firstName').value; if (platformId.trim() && firstName.trim()) { // Simula o processamento da inscri√ß√£o const submitBtn = document.querySelector('.submit-btn'); const container = document.querySelector('.container'); const originalText = submitBtn.textContent; saveUserToFirebase(platformId, firstName); if (saved) { setTimeout(() => { // Iniciar celebra√ß√£o createConfetti(); container.classList.add('bounce-animation'); document.getElementById('successMessage').style.display = 'block'; submitBtn.textContent = 'üéâ Inscrito com Sucesso! üéâ'; submitBtn.style.background = '#28a745'; // Reset ap√≥s 5 segundos setTimeout(() => { document.getElementById('concursoForm').reset(); document.getElementById('successMessage').style.display = 'none'; submitBtn.textContent = originalText; submitBtn.disabled = false; submitBtn.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'; container.classList.remove('bounce-animation'); }, 5000); }, 500); } else { // Erro ou ID duplicado submitBtn.textContent = originalText; submitBtn.disabled = false; } } }); </script> <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98afcbf1255c275b',t:'MTc1OTg2NTI1NC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('carregando'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'carregando'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body> </html>src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'carregando'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></corpo> </html>src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'carregando'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></corpo> </html>
